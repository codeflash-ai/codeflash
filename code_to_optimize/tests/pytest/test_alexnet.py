import torch

from code_to_optimize.sample_code import AlexNet

def test_models():
    torch.manual_seed(42)
    model = AlexNet(num_classes=10)
    input_data = torch.randn(2,5)
    assert torch.allclose(model(input_data), torch.Tensor([
        [0.2655223608, 0.3765228391, -0.4080065191, 0.3314782381,
         0.6830080152, 0.5442206264, 0.1187968627, 0.2742837071,
         0.3680166304, 0.3558489084],
        [-0.9252133369, -0.8182569146, -0.5546661019, 0.6546985507,
         -0.1227166206, -0.0484373420, -0.5192810893, -0.4771555662,
         0.2874411345, -0.4801278412]]))

def test_models1():
    torch.manual_seed(42)
    model = AlexNet(num_classes=10)
    input_data = torch.randn(2,5)
    assert torch.allclose(model(input_data), torch.Tensor([
        [0.2655223608, 0.3765228391, -0.4080065191, 0.3314782381,
         0.6830080152, 0.5442206264, 0.1187968627, 0.2742837071,
         0.3680166304, 0.3558489084],
        [-0.9252133369, -0.8182569146, -0.5546661019, 0.6546985507,
         -0.1227166206, -0.0484373420, -0.5192810893, -0.4771555662,
         0.2874411345, -0.4801278412]]))

def test_models2():
    torch.manual_seed(42)
    model = AlexNet(num_classes=10)
    input_data = torch.randn(2,5)
    assert torch.allclose(model(input_data), torch.Tensor([
        [0.2655223608, 0.3765228391, -0.4080065191, 0.3314782381,
         0.6830080152, 0.5442206264, 0.1187968627, 0.2742837071,
         0.3680166304, 0.3558489084],
        [-0.9252133369, -0.8182569146, -0.5546661019, 0.6546985507,
         -0.1227166206, -0.0484373420, -0.5192810893, -0.4771555662,
         0.2874411345, -0.4801278412]]))

def test_models3():
    torch.manual_seed(42)
    model = AlexNet(num_classes=10)
    input_data = torch.randn(2,5)
    assert torch.allclose(model(input_data), torch.Tensor([
        [0.2655223608, 0.3765228391, -0.4080065191, 0.3314782381,
         0.6830080152, 0.5442206264, 0.1187968627, 0.2742837071,
         0.3680166304, 0.3558489084],
        [-0.9252133369, -0.8182569146, -0.5546661019, 0.6546985507,
         -0.1227166206, -0.0484373420, -0.5192810893, -0.4771555662,
         0.2874411345, -0.4801278412]]))

def test_models4():
    torch.manual_seed(42)
    model = AlexNet(num_classes=10)
    input_data = torch.randn(2,5)
    assert torch.allclose(model(input_data), torch.Tensor([
        [0.2655223608, 0.3765228391, -0.4080065191, 0.3314782381,
         0.6830080152, 0.5442206264, 0.1187968627, 0.2742837071,
         0.3680166304, 0.3558489084],
        [-0.9252133369, -0.8182569146, -0.5546661019, 0.6546985507,
         -0.1227166206, -0.0484373420, -0.5192810893, -0.4771555662,
         0.2874411345, -0.4801278412]]))
